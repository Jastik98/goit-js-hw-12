{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport default function fetchingGallery() {\n  let pageNumber = 1;\n  const numberChoose = 15;\n\n  async function fetchingGalleryPage(userRequest) {\n    const searchParams = new URLSearchParams({\n      key: '43477228-b93f3de915bee922623f7f3db',\n      q: userRequest,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: pageNumber,\n      per_page: numberChoose,\n    });\n\n    const response = await axios.get(\n      `https://pixabay.com/api/?${searchParams}`\n    );\n\n    pageNumber++;\n\n    const { hits, totalHits } = response.data;\n\n    const pageLimit = Math.ceil(totalHits / numberChoose);\n    const lastPage = pageNumber > pageLimit;\n    return { hits, lastPage };\n  }\n  function resetLastPageNumber() {\n    pageNumber = 1;\n  }\n  return { fetchingGalleryPage, resetLastPageNumber };\n}\n","export default function renderGallery(requestedHits, galleryNode) {\n  let markup = '';\n\n  requestedHits.forEach(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      markup += `<li class=\"gallery-item\">\n    <a class=\"gallery-item__link\" href=\"${largeImageURL}\">\n    <img\n    src=\"${webformatURL}\"\n    alt=\"${tags}\"\n    /></a>\n    <ul class=\"image-descr\">\n    <li>\n      <span>Likes</span>\n      <span>${likes}</span>\n    </li>\n    <li>\n      <span>Views</span>\n      <span>${views}</span>\n    </li>\n    <li>\n      <span>Comments</span>\n      <span>${comments}</span>\n    </li>\n    <li>\n      <span>Downloads</span>\n      <span>${downloads}</span>\n    </li>\n  </ul>\n  </li>`;\n    }\n  );\n\n  galleryNode.insertAdjacentHTML('beforeend', markup);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport fetchingGallery from './js/pixabay-api';\nimport renderGallery from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('button[data-load]');\n\nconst { fetchingGalleryPage, resetLastPageNumber } = fetchingGallery();\nlet userRequest = '';\n\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// Кнопка seach\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  userRequest = event.target.elements.requestValue.value.trim();\n\n  if (!userRequest) {\n    return;\n  }\n\n  resetLastPageNumber();\n  clearGallery();\n  showLoader(searchForm);\n  hideLoadMoreBtn();\n\n  try {\n    const { hits: firstPage, isLastPage } = await fetchingGalleryPage(\n      userRequest\n    );\n\n    if (!firstPage.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      removeLoader();\n\n      return;\n    }\n\n    renderGallery(firstPage, galleryList);\n    galleryLightbox.refresh();\n\n    removeLoader();\n    showLoadMoreBtn(isLastPage);\n  } catch (error) {\n    console.error(error);\n\n    iziToast.error({\n      message: 'Ooops! Something went wrong. Try again later',\n      position: 'topRight',\n    });\n\n    removeLoader();\n  }\n  searchForm.reset();\n});\n// Кнопка Лоад Моо\nloadMoreBtn.addEventListener('click', async () => {\n  showLoader(galleryList);\n  hideLoadMoreBtn();\n  const { hight: itemHight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  try {\n    const { hits: nextPage, lastPage } = await fetchingGalleryPage(userRequest);\n    removeLoader();\n    renderGallery(nextPage, galleryList);\n    galleryLightbox.refresh();\n    window.scrollBy(0, itemHight * 2);\n    showLoadMoreBtn(lastPage);\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'Ooops! Something went wrong. Try again later',\n      position: 'topRight',\n    });\n\n    removeLoader();\n  }\n});\n\nfunction showLoader(loader) {\n  loader.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n}\nfunction removeLoader(loaderNode = document.querySelector('.loader')) {\n  if (loaderNode) {\n    loaderNode.remove();\n  }\n}\nfunction showLoadMoreBtn(lastPage) {\n  if (loadMoreBtn.classList.contains('visually-hidden')) {\n    if (lastPage) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      loadMoreBtn.classList.remove('visually-hidden');\n    }\n  }\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add('visually-hidden');\n}\n\nfunction clearGallery() {\n  galleryList.innerHTML = '';\n}\n"],"names":["fetchingGallery","pageNumber","numberChoose","fetchingGalleryPage","userRequest","searchParams","response","axios","hits","totalHits","pageLimit","lastPage","resetLastPageNumber","renderGallery","requestedHits","galleryNode","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","galleryList","loadMoreBtn","galleryLightbox","SimpleLightbox","event","clearGallery","showLoader","hideLoadMoreBtn","firstPage","isLastPage","iziToast","removeLoader","showLoadMoreBtn","error","itemHight","nextPage","loader","loaderNode"],"mappings":"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"}